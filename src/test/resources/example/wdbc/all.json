{
  "requests": [
    {
      "name": "TestCreatePMMLElementRequest",
      "description": "A test request",
      "processor": {
        "spi": "RequestProcessor",
        "impl": "ml.shifu.core.di.builtin.processor.CreatePMMLElementRequestProcessor",
        "params": {
          "pathPMML": "./model.xml",
          "overrideExistingModel": true
        }
      },
      "bindings": [
        {
          "spi": "PMMLDataDictionaryCreator",
          "impl": "ml.shifu.core.di.builtin.datadictionary.CSVPMMLDataDictionaryCreator",
          "params": {
            "delimiter": "|",
            "pathCSV": "./data/wdbc.header",
            "fields": [
              {
                "namePattern": "id",
                "params": {
                  "optype": "ordinal"
                }
              },
              {
                "namePattern": "diagnosis",
                "params": {
                  "optype": "categorical",
                  "dataType": "string"
                }
              },
              {
                "namePattern": "$default",
                "params": {
                  "optype": "continuous"
                }
              }
            ]
          }
        },
        {
          "spi": "PMMLModelElementCreator",
          "impl": "ml.shifu.core.di.builtin.DefaultPMMLModelElementCreator",
          "params": {
            "modelType": "NeuralNetwork",
            "modelName": "demoModel"
          }
        },
        {
          "spi": "PMMLTargetsCreator",
          "impl": "ml.shifu.core.di.builtin.targets.BinaryPMMLTargetsCreator",
          "params": {
            "modelName": "demoModel",
            "targetFieldName": "diagnosis",
            "posFieldValue": "M",
            "posFieldDisplayValue": "Malignant",
            "negFieldValue": "B",
            "negFieldDisplayValue": "Benign"
          }
        },
        {
          "spi": "PMMLMiningSchemaCreator",
          "impl": "ml.shifu.core.di.builtin.miningschema.DefaultPMMLMiningSchemaCreator",
          "params": {
            "modelName": "demoModel",
            "fields": [
              {
                "namePattern": "id",
                "params": {
                  "usageType": "supplementary"
                }
              },
              {
                "namePattern": "diagnosis",
                "params": {
                  "usageType": "target"
                }
              },
              {
                "namePattern": "$default",
                "params": {
                  "usageType": "active"
                }
              }
            ]
          }
        }
      ]
    },
    {
      "name": "CalcStatsRequest",
      "description": "step 2, calculate stats",
      "processor": {
        "spi": "RequestProcessor",
        "impl": "ml.shifu.core.di.builtin.processor.LocalCalcStatsRequestProcessor",
        "params": {
          "pathPMML": "./model.xml"
        }
      },
      "bindings": [
        {
          "spi": "UnivariateStatsCalculator",
          "impl": "ml.shifu.core.di.builtin.stats.BinomialUnivariateStatsCalculator",
          "params": {
            "modelName": "demoModel",
            "targetFieldName": "diagnosis",
            "pathInputData": "./data/wdbc.train",
            "numBins": 10,
            "negTags": [
              "B"
            ],
            "posTags": [
              "M"
            ]

          }
        }

      ]
    },
    {
      "name": "UpdateMiningSchemaRequest",
      "description": "step 3, var select",
      "processor": {
        "spi": "RequestProcessor",
        "impl": "ml.shifu.core.di.builtin.processor.UpdateMiningSchemaRequestProcessor",
        "params": {
          "pathPMML": "./model.xml"
        }
      },
      "bindings": [
        {
          "spi": "PMMLMiningSchemaUpdater",
          "impl": "ml.shifu.core.di.builtin.miningschema.IVVariableSelector",
          "params": {
            "numSelected": 10,
            "modelName": "demoModel"
          }
        }

      ]
    },
    {
      "name": "CreateLocalTransformations",
      "description": "step 3, var select",
      "processor": {
        "spi": "RequestProcessor",
        "impl": "ml.shifu.core.di.builtin.processor.CreatePMMLElementRequestProcessor",
        "params": {
          "pathPMML": "./model.xml"
        }
      },
      "bindings": [
        {
          "spi": "PMMLLocalTransformationsCreator",
          "impl": "ml.shifu.core.di.builtin.transform.DefaultLocalTransformationsCreator",
          "params": {
            "modelName": "demoModel",
            "fields": [
              {
                "namePattern": "id"
              },
              {
                "namePattern": "diagnosis",

                "binding": {
                  "spi": "PMMLDerivedFieldCreator",
                  "impl": "ml.shifu.core.di.builtin.derivedfield.BinaryClassMapperCreator",
                  "params": {
                    "posTags": [
                      "M"
                    ],
                    "negTags": [
                      "B"
                    ]
                  }
                }
              },
              {
                "namePattern": "$default",
                "binding": {
                  "spi": "PMMLDerivedFieldCreator",
                  "impl": "ml.shifu.core.di.builtin.derivedfield.ZScorePMMLDerivedFieldCreator"
                }

              }
            ]
          }
        }
      ]
    },
    {
      "name": "ExecLocalTransformations",
      "description": "step 5, execute transformations",
      "processor": {
        "spi": "RequestProcessor",
        "impl": "ml.shifu.core.di.builtin.processor.LocalModeTransformRequestProcessor",
        "params": {
          "modelName": "demoModel",
          "pathPMML": "./model.xml",
          "pathInputData": "./data/wdbc.train",
          "pathOutputData": "./generated/normalized.txt",
          "pathOutputActiveHeader": "./generated/normalized_header.txt"
        }
      },
      "bindings": [
        {
          "spi": "TransformationExecutor",
          "impl": "ml.shifu.core.di.builtin.transform.DefaultTransformationExecutor"
        }
      ]
    },
    {
      "name": "Train",
      "description": "step 6, train",
      "processor": {
        "spi": "RequestProcessor",
        "impl": "ml.shifu.plugin.encog.trainer.EncogTrainRequestProcessor",
        "params": {
          "modelName": "demoModel",
          "pathPMML": "./model.xml",
          "pathPMMLOutput": "./model_output.xml",
          "pathNormalizedData": "./generated/normalized.txt",
          "pathNormalizedHeader": "./generated/normalized_header.txt"
        }
      },
      "bindings": [
        {
          "spi": "Trainer",
          "impl": "ml.shifu.plugin.encog.trainer.EncogNNTrainer",
          "params": {
            "pathOutput": "./generated/models",
            "numEpochs": 100,
            "trainerID": "test",
            "splitRatio": 0.8,
            "algorithm": "Q",
            "learningRate": 0.5,
            "hiddenLayers": [
              {
                "numHiddenNodes": 10,
                "activationFunction": "sigmoid"
              }
            ]
          }

        }
      ]
    },
    {
      "name": "ModelExec",
      "description": "step 7, execute model",
      "processor": {
        "spi": "RequestProcessor",
        "impl": "ml.shifu.core.di.builtin.processor.ModelExecRequestProcessor",
        "params": {
          "modelName": "demoModel",
          "pathPMML": "./model_output.xml",
          "pathData": "./data/wdbc.eval",
          "pathHeader": "./data/wdbc.header",
          "pathResult": "./generated/score.json"
        }
      },
      "bindings": []
    },
    {
      "name": "ModelEval",
      "description": "step 8s",
      "processor": {
        "spi": "RequestProcessor",
        "impl": "ml.shifu.core.di.builtin.processor.ModelEvalRequestProcessor",
        "params": {
          "modelName": "demoModel",
          "posTags": ["M"],
          "negTags": ["B"],
          "pathScoreResult": "./generated/score.json" ,
          "samplePoints": [0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 0.91, 0.92, 0.93, 0.94, 0.95, 0.96, 0.97, 0.98, 0.99, 1.0]
        }
      },
      "bindings": []
    }


  ]
}